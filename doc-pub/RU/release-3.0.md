# Release 3.0

## Release 3.0

Тип: Мажорный релиз\
Версия: v3.0\
Краткое описание: Крупное обновление — ребрендинг в K12KB, нативные движки предиктивного ввода и перевода, клавиатура эмодзи, редизайн экранных клавиатур (sym, swipe, nav), редизайн интерфейса со светлой/тёмной темой

### Описание релиза

Релиз 3.0 посвящен:

* Ребрендинг из KeyoneKB в K12KB с новым namespace и иконкой
* Полноценный движок предиктивного ввода с нативным SymSpell (C99 + JNI)
* Оффлайн-перевод с контекстным фразовым подбором
* Клавиатура эмодзи
* Редизайн экранных клавиатур SYM, SWIPE, NAV
* Полный редизайн интерфейса и настроек со светлой/тёмной темой

### Ребрендинг

* Изменён namespace приложения на `com.ai10.k12kb`
* Все внутренние ссылки переименованы из keyonekb/keyonekb2 в k12kb
* Новая иконка K12KB в тёмно-синих тонах (deep sea blue)
* Версия повышена до 3.0

### Движок предиктивного ввода

* Добавлен предиктивный ввод с панелью подсказок (на базе Pastiera)
* **Нативный движок SymSpell** на C99 с JNI-биндингами для aarch64 — значительно быстрее Java-реализации
* Словари расширены до 750 тысяч слов на базе wordfreq (OpenSubtitles 2018)
* **Переключатели размера словарей** — на выбор: tiny, normal, big и full
* Бинарный формат кеша для быстрой загрузки словарей между перезапусками IME
* Статический движок кеширует словари между перезапусками IME, не перезагружая их
* Последовательная предзагрузка словарей при старте (сначала EN, потом RU)
* Загрузка с тротлингом для предотвращения лагов при наборе текста
* Toast-уведомление при наборе текста во время загрузки словаря
* Статус словарей и управление кешем в экране настроек подсказок
* Настраиваемое количество подсказок (1–6 слотов)
* **Ctrl+W** — переключение панели подсказок вкл/выкл
* Настройка для полного включения/выключения предиктивного ввода
* Настройка для отключения автокапитализации
* Настройка для отключения keyboard-aware коррекций
* Обучение на набираемом тексте (клавиатура учится по мере ввода)
* Интеграция с Пользовательским Словарем (Android UserDictionary) для предиктивного ввода

### Оффлайн-перевод

* **Оффлайн-перевод из файлов** отображается в подсказках-пилюлях
* **Нативный CDB-based движок перевода** для быстрых словарных запросов
* Словари перевода на основе OpenRussian (словоформы) + Wiktionary
* Контекстный фразовый перевод с использованием биграмных словарей
* Биграмный контекстный словарь для перевода с учётом предыдущего слова
* Фразовый перевод заменяет оба слова при принятии фразового совпадения
* Словари перевода отсортированы по частотности слова целевого языка
* Отдельная настройка количества пилюль перевода
* Переключатели размера словарей перевода (tiny, normal, big, full)
* **Ctrl+T** — переключение перевода вкл/выкл

### Клавиатура эмодзи

* Добавлена клавиатура эмодзи с 5 страницами смайликов
* Заменены Emoji 11.0+ на совместимые Emoji 5.0 для поддержки Android 8.x
* Видимая метка EMO на SYM-панели для быстрого доступа

### Панель подсказок

* Панель подсказок перестилизована под дизайн наэкранной клавиатуры
* Динамическая ширина слотов в зависимости от длины текста с пропорциональным взвешиванием
* Приоритетное слово отображается полностью в центральном слоте, никогда не обрезается
* Неприоритетные слова обрезаются с начала (показываются окончания)
* Пустые слоты скрываются, оставшиеся заполняют доступное пространство
* Панель подсказок сдвигает контент приложения вверх через onComputeInsets
* Панель остаётся видимой при отключённой свайп-панели

### Редизайн интерфейса и настроек

* **Светлая тема** с переключателем в настройках
* Редизайн GUI с тёмными пилюлями и компактной раскладкой
* Числа в настройках выделены кружками
* Текст пилюль обрезается многоточием, клик раскрывает полный текст
* Сохранение/загрузка настроек в структурированном JSON (включая секции json\_patches и swipe\_modes)
* Переключатель языка интерфейса на главном экране
* Сворачиваемая группа выданных разрешений с учётом темы оформления
* Перекомпоновка главного экрана с динамическим позиционированием элементов
* Русские переводы экранов настроек (Оформление, Подсказки, Бэкап)

### JS-патчи

* Человекочитаемые имена на пилюлях JS-патчей (из комментариев `// @name` в файлах)
* JS-патчи сгруппированы по имени ресурса с подзаголовками
* Клик по тексту пилюли JS-патча открывает файл в редакторе (отдельно от переключателя)
* Русские переводы toast-сообщений редактора JS-патчей
* Секция JS PATCHES полностью скрыта, если на SD-карте нет файлов патчей
* JS-патчи загружаются только с SD-карты (без автоматической выгрузки из assets)
* **Добавлен JSpatch: Disable chats reading/scrolling** — режим по умолчанию

### Горячие клавиши

| Сочетание      | Действие                              |
| -------------- | ------------------------------------- |
| Ctrl+W         | Переключение панели подсказок вкл/выкл |
| Ctrl+T         | Переключение перевода вкл/выкл         |
